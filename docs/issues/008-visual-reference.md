# ジョブ解放条件表示 - ビジュアルリファレンス

## 方式B (プログレスバー形式) - 実装完了

### カード表示

#### 未解放ジョブ
```
┌─────────────────────┐
│ 🔒 66%              │ ← 進捗バッジ (左上)
│                     │
│     [ドット絵]       │
│                     │
│ 戦士                │
└─────────────────────┘
```

#### 解放済みジョブ
```
┌─────────────────────┐
│               ✅    │ ← チェックマーク (右上)
│                     │
│     [ドット絵]       │
│                     │
│ 戦士                │
│ そうび              │ ← 装備中バッジ (該当する場合)
└─────────────────────┘
```

---

### Popover表示 (未解放ジョブ)

```
┌──────────────────────────────────────┐
│ 戦士                                  │
│                                      │
│ 強靭な肉体を持つ者                    │
│ ──────────────────────────────────── │
│ 解放条件:                             │
│                                      │
│ レベル: 12 / 10 ✅                   │
│ [████████████████░░] 120%            │
│                                      │
│ ちから: 7 / 5 ✅                     │
│ [████████████████░░] 140%            │
│                                      │
│ しょくぎょう: 見習い戦士 ❌           │
│ [░░░░░░░░░░░░░░░░░░] 0%             │
│ ──────────────────────────────────── │
│ 達成: 2/3 (66%)                       │
│ [████████████░░░░░░] 66%             │
│                                      │
│ ※ まだ解放されていません              │
└──────────────────────────────────────┘
```

### Popover表示 (解放済み・未装備ジョブ)

```
┌──────────────────────────────────────┐
│ 戦士                                  │
│                                      │
│ 強靭な肉体を持つ者                    │
│                                      │
│ ┌────────────────────────────────┐   │
│ │  🗡️  そうびする                │   │ ← 装備ボタン
│ └────────────────────────────────┘   │
└──────────────────────────────────────┘
```

### Popover表示 (装備中ジョブ)

```
┌──────────────────────────────────────┐
│ 戦士  [そうびちゅう]                  │ ← バッジ表示
│                                      │
│ 強靭な肉体を持つ者                    │
└──────────────────────────────────────┘
```

---

## カラーパレット

### プログレスバー
- **達成済み**: `bg-gradient-to-r from-green-600 to-green-400`
- **未達成**: `bg-gradient-to-r from-purple-600 to-purple-400`
- **背景**: `bg-slate-800`

### テキスト
- **達成済み**: `text-green-400`
- **未達成**: `text-slate-400`
- **ラベル**: `text-purple-400`

### アイコン
- **達成**: ✅ (Check) `text-green-400`
- **未達成**: ❌ (X) `text-red-400`

### バッジ
- **進捗バッジ**: `bg-slate-900/90 border-purple-600/50`
- **装備中バッジ**: `bg-yellow-600`
- **解放済みバッジ**: `bg-green-600`

---

## 条件タイプ別表示

### 1. レベル条件
```
レベル: 8 / 10 ❌
[████████████████░░░░] 80%
```

### 2. ステータス条件
```
ちから: 3 / 5 ❌
[████████████░░░░░░░░] 60%

かしこさ: 10 / 8 ✅
[████████████████████] 125% → 100%で表示
```

### 3. ジョブ条件
```
しょくぎょう: 見習い戦士 ❌
[░░░░░░░░░░░░░░░░░░░░] 0%

しょくぎょう: ビギナー ✅
[████████████████████] 100%
```

### 4. アチーブメント条件
```
しょうごう: 早起きマスター ❌
[░░░░░░░░░░░░░░░░░░░░] 0%

しょうごう: 習慣の達人 ✅
[████████████████████] 100%
```

---

## レスポンシブ対応

### デスクトップ (1920x1080)
- グリッド: `grid-cols-4`
- カードサイズ: 通常
- Popoverサイズ: `w-80`

### タブレット (768x1024)
- グリッド: `grid-cols-4` (継続)
- テキストサイズ: `md:text-xs`
- アイコンサイズ: `md:w-10 md:h-10`

### モバイル (375x667)
- グリッド: `grid-cols-4` (継続、コンパクト表示)
- テキストサイズ: `text-[10px]`
- アイコンサイズ: `w-6 h-6`
- Popoverは画面幅いっぱいに調整

---

## 実装詳細

### データフロー

```
shared/constants/jobs.ts (JOBS: JobDefinition[])
  ↓
UserContext.tsx (jobs, userJobs, userData, achievements, userAchievements)
  ↓
Achievements.tsx
  ↓ mergedJobs.map()
utils/jobRequirements.ts
  ├─ checkJobRequirements() → RequirementCheckResult[]
  └─ getJobUnlockProgress() → { completed, total, percentage }
  ↓
UI Rendering:
  ├─ Card: progress badge
  └─ Popover: detailed progress bars
```

### 型定義

```typescript
interface RequirementCheckResult {
  type: 'level' | 'stats' | 'jobs' | 'achievements';
  label: string;
  required: number | string;
  current: number | string;
  isMet: boolean;
  percentage: number; // 0-100
}

interface JobProgress {
  completed: number;
  total: number;
  percentage: number;
}
```

---

## アニメーション

### プログレスバー
- トランジション: `transition-all`
- アニメーション: 幅の変化がスムーズに表示される

### Popover
- 開閉: スムーズなフェードイン/アウト
- ポジショニング: 自動調整 (画面端で反転)

---

## アクセシビリティ

- [ ] カラーコントラスト比: WCAG AA準拠
- [ ] キーボードナビゲーション: Popoverをキーボードで操作可能
- [ ] スクリーンリーダー: ラベルとステータスを読み上げ可能
- [ ] ホバー/フォーカス: 両方で Popover が開く

---

## パフォーマンス最適化

- `map()` で動的生成 (36個のジョブ)
- 条件なしジョブは計算スキップ
- プログレスバーは CSS transform ではなく width 使用 (GPU 最適化の余地あり)
